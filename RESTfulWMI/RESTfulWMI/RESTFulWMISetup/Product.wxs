<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?define BUILDTARGET="..\Test\bin\Release\" ?>
  <Product Id="bb227452-8611-4e01-bfe0-d3f91dcc1ef9"
           Name="RESTFulWMISetup"
           Language="1033" Version="1.0.0.0"
           Manufacturer="RESTFulWMISetup"
           UpgradeCode="9724e2e5-8746-4c86-978d-29166b6f49b3">
    <Package InstallerVersion="200" Compressed="yes" />

    <Media Id="1" Cabinet="media1.cab" EmbedCab="yes" />
    <Condition Message="You must have administrator privileges to install the application.">
      <![CDATA[Privileged]]>
    </Condition>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLLOCATION" Name="WindowsServer2012WMIService">
          
          <Component Id="WindowsServer2012WMIComponent" Guid="08D9CCF3-FCB3-43CA-9460-8527138718D2">
            <File Id="service_exe" Name="Test.exe" Source="$(var.BUILDTARGET)Test.exe"></File>
            <File Id="user_business_object" Name="UserBusinessObject.dll" Source="$(var.BUILDTARGET)UserBusinessObject.dll"></File>
            <ServiceInstall Id="WindowsServer2012WMIServiceInstaller" Type="ownProcess" Vital="yes" Name="ws2012wmisvc6" 
                            DisplayName="Windows Server 2012 Essentials WMI Service6" 
                            Description="This service provides the wmi part of the windows server 2012 essentials." 
                            Start="demand" 
                            Account="LocalSystem" ErrorControl="ignore" Interactive="no">
            </ServiceInstall>
            <ServiceControl Id="StartService" Stop="both" Remove="uninstall" Name="ws2012wmisvc2"/>
            
          </Component>
          <Directory Id="GAC" Name="GAC">
            <Component Id="UserBusinessObjectGAC" Guid="22887611-B13E-41EE-897C-D78830E68AEB">
              <File Id="user_business_object_gac" Name="UserBusinessObject.dll" Source="$(var.BUILDTARGET)UserBusinessObject.dll" Assembly=".net" KeyPath="yes"></File>
            </Component>
            <Component Id="TestGAC" Guid="28E9E9B3-3F34-427E-B003-C49B61836E48">
              <File Id="test_exe_gac" Name="Test.exe" Source="$(var.BUILDTARGET)Test.exe" Assembly=".net" KeyPath="yes"></File>
            </Component>
          </Directory>
        </Directory>
      </Directory>
    </Directory>

    <Feature Id="ProductFeature" Title="RESTFulWMISetup" Level="1">
      <!-- TODO: Remove the comments around this ComponentRef element and the Component above in order to add resources to this installer. -->
      <!-- <ComponentRef Id="ProductComponent" /> -->

      <!-- Note: The following ComponentGroupRef is required to pull in generated authoring from project references. -->
      <ComponentRef Id="WindowsServer2012WMIComponent" />
      <ComponentRef Id="UserBusinessObjectGAC"/>
      <ComponentRef Id="TestGAC"/>
    </Feature>
  </Product>
</Wix>
