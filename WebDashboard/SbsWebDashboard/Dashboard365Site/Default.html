<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script charset="UTF-8" type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.3&mkt=en-us">
</script>

    <script type="text/javascript" src="./Scripts/jquery-1.5.1.min.js"></script>
    <script type="text/javascript" src="./Scripts/jquery-ui-1.8.13.custom.min.js"></script>
    <script type="text/javascript" src="./Scripts/jquery.tmpl.min.js"></script>
    <script type="text/javascript" src="./Scripts/functionPointHandlers.js"></script>
    <script type="text/javascript" src="./Scripts/mockdata.js"></script>
    <script type="text/javascript" src="./Scripts/gettmpl.js"></script>
    <script type="text/javascript" src="./Scripts/authenticationHandlers.js"></script>
    <script type="text/javascript" src="./Scripts/locationHandler.js"></script>
    <script type="text/javascript" src="./Scripts/remoteDesktopHandler.js"></script>
    <script type="text/javascript" src="./Scripts/jquery.cookie.js"></script>

    <link href="./Styles/fp.css" rel="stylesheet" type="text/css" />
    <link href="./Styles/map.css" rel="Stylesheet" type="text/css" />
    <script type="text/javascript">
//        var ii = { UserName: "a", PassWord: "\?\?b", TimeStamp: 1 };
//        var xx = JSON.stringify(ii);
//        Dashboard365Login(xx, function (data) { });

        function renderRemoteDesktop() {
//            if (!window.WebSocket) {
//                alert("WebSocket not supported by this browser!");
//            }
            $.getTmpl("/templates/remoteDesktopTemplate.html").done(function () {
                $locationsTmpl = $("#remoteDesktopTemplate").tmpl(null);
                $locationsTmpl.appendTo("body");
                RemoteMachine("localhost");
            }); 

        }
        function renderMap() {
            $.getTmpl("/templates/locationsTemplate.html").done(function () {
                $locationsTmpl = $("#locationsTemplate").tmpl(null);
                $locationsTmpl.appendTo("body");

                var map = new VEMap('locationMap');
                map.LoadMap();
                queryUserLocations(function (data) {
                    var i = 0;
                    for (i = 0; i < data.length; i++) {
                        var userLocation = data[i];
                        var shape = new VEShape(VEShapeType.Pushpin,
                        new VELatLong(userLocation.Latitude, userLocation.Longitude));
                        shape.SetTitle(userLocation.UserName);
                        shape.SetDescription(userLocation.UserName);
                        map.AddShape(shape);
                    }
                });
            });
        }
        function renderFunctionPoints() {

            $.getTmpl("/templates/functionTemplate.htm").done(function () {
                queryFunctionPointsForUserAndAddIn
                (CurrentUser,"main", function (functionPoints) {
                    for (var i in functionPoints) {
                        var fp = functionPoints[i];
                        $ftmpl = $("#ftemplate").tmpl(fp);
                        $ftmpl.attr("href", fp.NavigationUrl)
                        $ftmpl.appendTo("#sortable");
                    }
                });
            });
        }
        $(document).ready(function () {
            //renderFunctionPoints();
           // renderMap();
            renderRemoteDesktop();
            //$("#sortable").sortable();
            //$("#sortable").disableSelection();
        });
    
    </script>
</head>
<body>
    <div class="pageContent">
        <div class="loadingMessage">
            Page is loading......</div>
        <div id="sortable">
        </div>
        <div style="clear: both" />
    </div>
</body>
</html>
